webpackJsonp([7],{"3YMB":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("Yj4y");var s=n("a8Zu"),i=(n("VOH9"),n("9lIC")),a=n("hUrq"),o=n("qwAB"),r=n("2Uyi"),c=n("gyMJ"),l={data:function(){return{showAnswerDialog:!1,showPopup:!1,content:"",details:{from:{},cate:{}},bestAnswer:{},normalAnser:[],type:"",popTitle:"",popContent:""}},components:{HeaderMain:a.a,Scroll:o.a},created:function(){this.question_id=this.$route.query.id,this._reqDetail(),this._reqWatchNum()},computed:{popupTitle:function(){return"answer"===this.type?"修改回答":"question"===this.type?"修改问题":void 0},popupLable:function(){return"answer"===this.type?"答案":"question"===this.type?"描述":void 0}},methods:{_checkToken:function(){var t=this;return!!localStorage.getItem("token")||(i.a.confirm({title:"温馨提示",message:"登录后才能回答问题哦，老铁。",confirmButtonText:"去登陆"}).then(function(){t.$router.push("/login")}).catch(function(){console.log("已关闭")}),!1)},handleAnswerAndReplyCancel:function(){this.content=""},handleSubmitModify:function(){if("question"===this.type){if(!this.popupTitle)return Object(s.a)("请输入标题");this._reqModifyQues()}if("answer"===this.type){if(!this.popContent)return Object(s.a)("请输入答案");this._reqModifyAnswer()}},handleAdoptClick:function(t,e){var n=this;i.a.confirm({title:"温馨提示",message:"确认采纳该答案为最佳答案吗？"}).then(function(){n.answer_id=e.answer_id,n.index=t,n.item=e,n._reqAdopy()}).catch(function(){Object(s.a)("已取消")})},handlePopupBack:function(){this.showPopup=!1},handleModifyQues:function(t,e,n){this.type=t,this.popTitle=e,this.popContent=n,this.showPopup=!0},handleModifyAnswer:function(t,e,n,s){this.type=t,this.answer_id=e,this.popContent=n,this.itemIndex=s,this.showPopup=!0},handleAnswerClick:function(){this._checkToken()&&(this.showAnswerDialog=!0,this.isReply=!1)},handleAnswerAndReplyConfirm:function(){if(!this.content)return this.showAnswerDialog=!0,Object(s.a)("请输入内容");this.isReply?this._reqReply():this._reqAnswer()},handleReplyClick:function(t){this._checkToken()&&(this.answer_id=t,this.showAnswerDialog=!0,this.isReply=!0)},_reqDetail:function(){var t=this;Object(c.e)(this.question_id).then(function(e){Object(r.c)(e,function(){t.details=e.data,t.normalAnser=[],e.data.answer.length&&e.data.answer.forEach(function(e){1===e.state&&(t.bestAnswer=e),0===e.state&&t.normalAnser.push(e)})})})},_reqAnswer:function(){var t=this;Object(c.p)(this.question_id,this.content).then(function(e){Object(r.c)(e,function(){t._reqDetail(),s.a.success("回答成功"),t.content=""})})},_reqModifyQues:function(){var t=this;Object(c.r)(this.question_id,this.popTitle,this.popContent).then(function(e){Object(r.c)(e,function(){t.details.title=t.popTitle,t.details.description=t.popContent,t.showPopup=!1,s.a.success("修改成功")})})},_reqModifyAnswer:function(){var t=this;Object(c.q)(this.answer_id,this.popContent).then(function(e){Object(r.c)(e,function(){t.normalAnser[t.itemIndex].content=t.popContent,t.showPopup=!1,s.a.success("修改成功")})})},_reqAdopy:function(){var t=this;Object(c.c)(this.answer_id,this.question_id).then(function(e){Object(r.c)(e,function(){t._reqDetail(),s.a.success("修改成功")})})},_reqReply:function(){var t=this;Object(c.t)(this.answer_id,this.content).then(function(e){Object(r.c)(e,function(){t._reqDetail(),s.a.success("回复成功"),t.content=""})})},_reqWatchNum:function(){Object(c.u)(this.question_id)}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"details"},[n("van-dialog",{staticClass:"answer-dialog",attrs:{"show-cancel-button":"",closeOnClickOverlay:""},on:{cancel:t.handleAnswerAndReplyCancel,confirm:t.handleAnswerAndReplyConfirm},model:{value:t.showAnswerDialog,callback:function(e){t.showAnswerDialog=e},expression:"showAnswerDialog"}},[n("van-field",{attrs:{label:"内容",type:"textarea",rows:"1",placeholder:"请输入"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),n("van-popup",{staticClass:"popup",attrs:{position:"right",overlay:!1},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[n("header-main",{attrs:{path:"path",title:t.popupTitle},on:{back:t.handlePopupBack}}),t._v(" "),n("br"),t._v(" "),n("van-cell-group",{attrs:{border:!1}},["question"===t.type?n("van-field",{attrs:{label:"标题",clearable:"",type:"textarea",rows:"2",autosize:"",border:!1},model:{value:t.popTitle,callback:function(e){t.popTitle=e},expression:"popTitle"}}):t._e(),t._v(" "),"question"===t.type?n("div",{staticClass:"border"}):t._e(),t._v(" "),n("van-field",{attrs:{label:t.popupLable,clearable:"",type:"textarea",rows:"3",border:!1,autosize:""},model:{value:t.popContent,callback:function(e){t.popContent=e},expression:"popContent"}}),t._v(" "),n("div",{staticClass:"border"})],1),t._v(" "),n("a",{staticClass:"submit-btn",attrs:{href:"javascript:;"},on:{click:t.handleSubmitModify}},[t._v("提交修改")])],1),t._v(" "),n("header-main",{attrs:{title:"问题详情"}}),t._v(" "),n("div",{staticClass:"scroll-box"},[n("scroll",[n("br"),t._v(" "),n("div",{staticClass:"ques-data"},[n("h2",[t._v(t._s(t.details.title))]),t._v(" "),n("div",{staticClass:"border"}),t._v(" "),n("div",{staticClass:"data"},[n("span",[t._v(t._s(t.details.from.nickname)+" 提问于 "+t._s(t.details.create_time))]),t._v(" "),n("span",[t._v(t._s(t.details.cate.cate_name))])]),t._v(" "),n("div",{staticClass:"border"}),t._v(" "),n("p",[t._v("问题补充："+t._s(t.details.description))]),t._v(" "),t.details.nowUserId===t.details.user_id?n("a",{staticClass:"submit-btn",attrs:{href:"javascript:;"},on:{click:function(e){return e.preventDefault(),t.handleModifyQues("question",t.details.title,t.details.description)}}},[t._v("修改问题")]):n("a",{staticClass:"submit-btn",attrs:{href:"javascript:;"},on:{click:function(e){return e.preventDefault(),t.handleAnswerClick(e)}}},[t._v("我来回答")])]),t._v(" "),t.bestAnswer.state?n("div",{staticClass:"best-answer"},[n("div",{staticClass:"title"},[t._v("最佳答案")]),t._v(" "),n("div",{staticClass:"contents"},[t._v(t._s(t.bestAnswer.content))]),t._v(" "),n("div",{staticClass:"infor"},[n("img",{attrs:{src:t.bestAnswer.from[0].avatar,alt:""}}),t._v(" "),n("div",[n("span",[t._v("回答者："+t._s(t.bestAnswer.from[0].nickname))]),t._v(" "),n("span",[t._v("回答时间："+t._s(t.bestAnswer.answer_time))])])])]):t._e(),t._v(" "),n("div",{staticClass:"border"}),t._v(" "),t._l(t.normalAnser,function(e,s){return n("div",{key:s,staticClass:"other-answer"},[n("div",{staticClass:"title"},[n("span",[t._v("其它回答")]),t._v(" "),n("div",[t.details.nowUserId===e.user_id?n("span",{on:{click:function(n){return t.handleModifyAnswer("answer",e.answer_id,e.content,s)}}},[t._v("修改")]):t._e(),t._v(" "),t.details.nowUserId!==t.details.user_id||t.bestAnswer.state?t._e():n("span",{on:{click:function(n){return t.handleAdoptClick(s,e)}}},[t._v("采纳")]),t._v(" "),n("span",{on:{click:function(n){return t.handleReplyClick(e.answer_id)}}},[t._v("回复")])])]),t._v(" "),n("div",{staticClass:"contents"},[t._v(t._s(e.content))]),t._v(" "),n("div",{staticClass:"infor"},[n("img",{attrs:{src:e.from[0].avatar,alt:""}}),t._v(" "),n("span",[t._v(t._s(e.from[0].nickname))]),t._v(" "),n("span",[t._v("|")]),t._v(" "),n("span",[t._v(t._s(e.answer_time))])]),t._v(" "),e.replys.length?n("div",{staticClass:"reply"},t._l(e.replys,function(e,s){return n("p",{key:s},[t._v(t._s(s+1)+"# "+t._s(e.user_id)+" 回复说："+t._s(e.reply_content))])}),0):t._e()])}),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("br")],2)],1)],1)},staticRenderFns:[]};var u=n("C7Lr")(l,p,!1,function(t){n("no6k"),n("PVKN")},"data-v-39111214",null);e.default=u.exports},PVKN:function(t,e){},no6k:function(t,e){}});
//# sourceMappingURL=7.fb71edb14a65dd2ed392.js.map